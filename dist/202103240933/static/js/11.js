webpackJsonp([11],{cSHE:function(n,t,e){var a=e("iXEy");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);e("rjj0")("0dc811fa",a,!0)},iXEy:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},sd0f:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={data:function(){return{draggable:!1,updateNodes:[],maximumDrag:0,titlemsg:"",submitType:"",category:{catId:null,name:"",parentCid:0,catLevel:0,showStatus:1,sort:0,icon:"",productUnit:""},menus:[],dialogVisible:!1,expandenKeys:[],defaultProps:{children:"subcategoryList",label:"name"}}},methods:{batchdel:function(){var n=this,t=[],e=this.$refs.tree.getCheckedNodes();if(e.length>0)for(var a=0;a<e.length;a++)t.push(e[a].catId),this.$confirm("是否批量删除"+t+"菜单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.$http({url:n.$http.adornUrl("/product/category/delete"),method:"post",data:n.$http.adornData(t,!1)}).then(function(e){e.data;n.getMethodsTree(),n.$message({type:"success",message:"菜单批量删除成功!"}),t=[]})}).catch(function(){n.$message({type:"info",message:"已取消删除"})});this.$message({message:"请选中你要批量删除的分类名称",type:"warning"})},handleDrop:function(n,t,e,a){var o=this;console.log("handleDrop: ",n,t,e,a);var s=0,i=null;"before"==e||"after"==e?(s=void 0==t.parent.data.catId?0:t.parent.data.catId,i=t.parent.childNodes):(s=t.data.catId,i=t.childNodes);for(var c=0;c<i.length;c++)if(i[c].data.catId==n.data.catId){var r=n.level;n.level!=i[c].level&&(r=i[c].level,this.updateChildNodeLevel(i[c])),this.updateNodes.push({catId:i[c].data.catId,sort:c,parentCid:s,catLevel:r})}else this.updateNodes.push({catId:i[c].data.catId,sort:c});console.log("updateNodes :>> ",this.updateNodes),this.$http({url:this.$http.adornUrl("/product/category/update/sort"),method:"post",data:this.$http.adornData(this.updateNodes,!1)}).then(function(n){n.data;o.$message({type:"success",message:"菜单顺序修改成功"}),o.getMethodsTree(),o.expandenKeys=[s],o.updateNodes=[],o.maximumDrag=0})},updateChildNodeLevel:function(n){if(n.childNodes.length>0)for(var t=0;t<n.childNodes.length;t++){var e=n.childNodes[t].data;this.updateNodes.push({catId:e.catId,catLevel:n.childNodes[t].level}),this.updateChildNodeLevel(n.childNodes[t])}},allowDrop:function(n,t,e){console.log("allowDrop :>> ",n,t,e),this.getMaximumDrag(n.data);var a=this.maximumDrag-n.data.catLevel+1;return console.log("深度 :>> ",a),"inner"==e?(console.log("this.maximumDrag:"+this.maximumDrag+" ---\x3e draggingNode.data.catLevel: "+n.data.catLevel+"  --\x3e dropNode.level "+t.level),a+t.level<=3):a+t.parent.level<=3},getMaximumDrag:function(n){if(null!=n.subcategoryList&&n.subcategoryList.length>0)for(var t=0;t<n.subcategoryList.length;t++)n.subcategoryList[t].catLevel>this.maximumDrag&&(console.log("交换位置 :>> ",n.subcategoryList[t].catLevel),this.maximumDrag=n.subcategoryList[t].catLevel),this.getMaximumDrag(n.subcategoryList[t])},recoveryCategory:function(){this.category.name="",this.category.catId=null,this.category.icon="",this.category.productUnit=""},submitCategory:function(){"add"==this.submitType&&this.saveCategory(),"edit"==this.submitType&&this.editCategory()},editCategory:function(){var n=this,t=this.category,e={name:t.name,catId:t.catId,icon:t.icon,productUnit:t.productUnit};this.$http({url:this.$http.adornUrl("/product/category/update"),method:"post",data:this.$http.adornData(e,!1)}).then(function(t){var e=t.data;console.log("菜单修改成功 :>> ",e),n.dialogVisible=!1,n.getMethodsTree(),n.expandenKeys=[n.category.parentCid],n.$message({type:"success",message:"菜单修改成功"})})},edit:function(n,t){var e=this;console.log("edit :>> ",n),console.log("edit :>> ",t),this.submitType="edit",this.titlemsg="修改分类",this.dialogVisible=!0,this.$http({url:this.$http.adornUrl("/product/category/info/"+t.catId),method:"get"}).then(function(n){var t=n.data;console.log("回显的数据是 :>> ",t),e.category.name=t.category.name,e.category.catId=t.category.catId,e.category.icon=t.category.icon,e.category.productUnit=t.category.productUnit,e.category.parentCid=t.category.parentCid})},saveCategory:function(){var n=this;console.log("category :>> ",this.category),this.$http({url:this.$http.adornUrl("/product/category/save"),method:"post",data:this.$http.adornData(this.category,!1)}).then(function(t){t.data;n.dialogVisible=!1,n.getMethodsTree(),n.expandenKeys=[n.category.parentCid],n.$message({type:"success",message:"菜单添加成功"})})},handleNodeClick:function(n){console.log(n),this.dialogVisible=!0},getMethodsTree:function(){var n=this;this.$http({url:this.$http.adornUrl("/product/category/list/tree"),method:"get"}).then(function(t){var e=t.data;console.log("data :>> ",e.data),n.menus=e.data})},append:function(n){console.log("append :>> ",n),this.submitType="add",this.titlemsg="添加分类",this.category.parentCid=n.catId,this.category.catLevel=1*n.catLevel+1,this.recoveryCategory()},remove:function(n,t){var e=this;console.log("node :>> ",n.parent.data.catId),console.log("data.catId :>> ",t.catId);var a=[t.catId];this.$confirm("是否删除当前"+t.name+"菜单, 是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http({url:e.$http.adornUrl("/product/category/delete"),method:"post",data:e.$http.adornData(a,!1)}).then(function(t){t.data;e.expandenKeys=[n.parent.data.catId],e.$message({type:"success",message:"菜单删除成功"}),e.getMethodsTree()})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}},created:function(){this.getMethodsTree()}},o={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",[e("el-switch",{attrs:{"active-color":"#13ce66","active-text":"开启拖拽","inactive-text":"关闭拖拽"},model:{value:n.draggable,callback:function(t){n.draggable=t},expression:"draggable"}}),n._v(" "),e("el-button",{attrs:{type:"danger"},on:{click:n.batchdel}},[n._v("批量删除")]),n._v(" "),e("el-tree",{ref:"tree",attrs:{data:n.menus,props:n.defaultProps,"node-key":"catId","show-checkbox":"",draggable:n.draggable,"highlight-current":"","allow-drop":n.allowDrop,"default-expanded-keys":n.expandenKeys,"expand-on-click-node":!1},on:{"node-click":n.handleNodeClick,"node-drop":n.handleDrop},scopedSlots:n._u([{key:"default",fn:function(t){var a=t.node,o=t.data;return e("span",{staticClass:"custom-tree-node"},[e("span",[n._v(n._s(a.label))]),n._v(" "),e("span",[o.catLevel<=2?e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return n.append(o)}}},[n._v("\n          Append\n        ")]):n._e(),n._v(" "),e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return n.edit(a,o)}}},[n._v("\n          Edit\n        ")]),n._v(" "),3==o.catLevel||0==o.subcategoryList?e("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(){return n.remove(a,o)}}},[n._v("\n          Delete\n        ")]):n._e()],1)])}}])}),n._v(" "),e("el-dialog",{attrs:{title:n.titlemsg,visible:n.dialogVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){n.dialogVisible=t}}},[e("el-form",{attrs:{model:n.category}},[e("el-form-item",{attrs:{label:"分类名称"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:n.category.name,callback:function(t){n.$set(n.category,"name",t)},expression:"category.name"}})],1),n._v(" "),e("el-form-item",{attrs:{label:"图标"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:n.category.icon,callback:function(t){n.$set(n.category,"icon",t)},expression:"category.icon"}})],1),n._v(" "),e("el-form-item",{attrs:{label:"计量单位"}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:n.category.productUnit,callback:function(t){n.$set(n.category,"productUnit",t)},expression:"category.productUnit"}})],1)],1),n._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){n.dialogVisible=!1}}},[n._v("取 消")]),n._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:n.submitCategory}},[n._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=e("VU/8")(a,o,!1,function(n){e("cSHE")},"data-v-4fc52866",null);t.default=s.exports}});